<!DOCTYPE html>

<html>
<head>
  {% extends 'base.html' %}
  {% block head %}
  {% endblock %}
</head>
<body>
    {% block body %}
    <br>
    <div class='blocktext'>
      <span class='error_msg'><i class="fas fa-asterisk fa-2x fa-spin fa-fw"></i></span>
    </div>
    <form action="{{ url_for('offleash_response') }}" method="POST" hidden>
      <input type="text" id="current_lat", name="current_lat">
      <input type="text" id="current_lng", name="current_lng">
    </form>
    <script>
      window.onload = function() {
        setTimeout(
          function() {
            //alert("Browser settings for location access must be turned on for this app to activate. Approve request if prompted. If you don't get prompted, you can change your browser settings or try a different browser.");
            if (confirm("OttLeash requires access to your location.\n\nPlease change browser settings or try with different browser. \n\nHit 'OK' if you need help with this.")) {
              window.open('https://stroly.zendesk.com/hc/en-us/articles/360034274111-How-to-turn-on-Location-Services-GPS-', '_blank')
            }
            else {
              window.open("{{url_for('index')}}", '_self')
            }
          }, 5000);
        var startPos;
        var geoSuccess = function(position) {
          startPos = position;
          lat = startPos.coords.latitude;
          lng = startPos.coords.longitude;
          console.log(lat);
          console.log(lng);
          document.getElementById('current_lat').value=lat
          document.getElementById('current_lng').value=lng
          document.forms[0].submit()
        };
        navigator.geolocation.getCurrentPosition(geoSuccess);
        clearTimeout();
      };
    </script>
    {% endblock %}
</body>
</html>
